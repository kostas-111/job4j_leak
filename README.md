# Демонстрация утечек памяти в Java

Этот проект демонстрирует проблему утечек памяти в Java, моделируя сценарии, в которых неиспользуемые объекты продолжают сохраняться в памяти из-за неправильного управления коллекциями и ссылками.

---

## Структура проекта

Проект включает следующие ключевые компоненты:

### 1. **Модели**
   - `User`: Представляет пользователя с именем.
   - `Comment`: Представляет комментарий, связанный с пользователем.
   - `Post`: Представляет пост, содержащий список комментариев.

### 2. **Генераторы**
   - `UserGenerator`: Генерирует 1000 случайных пользователей, используя заранее заданные имена, фамилии и отчества, загружаемые из файлов.
   - `CommentGenerator`: Генерирует 50 случайных комментариев, используя заранее заданные фразы и случайных пользователей.

### 3. **Хранилище**
   - `PostStore`: Хранит посты в памяти и предоставляет методы для добавления и удаления всех постов.

### 4. **Меню**
   - Консольное меню для взаимодействия с системой: создание постов, просмотр всех постов, очистка хранилища.

---

## Основные возможности

1. **Генераторы пользователей и комментариев**:
   - Динамически создают случайных пользователей и комментарии для каждого поста.
   - Загружают данные из внешних файлов (`names.txt`, `surnames.txt`, `phrases.txt`).

2. **Демонстрация утечек памяти**:
   - Показывает потенциальные утечки памяти из-за сохранения ссылок на объекты в статических полях и коллекциях.

3. **Интерактивное меню**:
   - Возможность создавать единичные или множественные посты, просматривать их и очищать хранилище.

---

## Настройка проекта

### Необходимое ПО
- Java Development Kit (JDK) версии 11 или выше.
- Maven для управления зависимостями.

### Установка
1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/ваш-репозиторий/memory-leak-demo.git
   ```
2. Перейдите в директорию проекта:
   ```bash
   cd memory-leak-demo
   ```
3. Скомпилируйте проект:
   ```bash
   mvn clean compile
   ```

### Запуск приложения
Для запуска консольного приложения выполните класс `Menu`:
```bash
java -cp target/classes ru.job4j.gc.leak.Menu
```

---

## Необходимые файлы

### Входные файлы
Убедитесь, что следующие файлы существуют в директории `src/main/java/ru/job4j/gc/leak/files/`:
- `names.txt` – Список имен.
- `surnames.txt` – Список фамилий.
- `phrases.txt` – Список фраз для комментариев.

### Пример данных
В директории `resources/sample-data` вы найдете примеры содержимого для файлов `names.txt`, `surnames.txt`, `phrases.txt`.

---

## Оптимизации

### Проблемы в текущей реализации
- **Статические коллекции**: Сохраняют ссылки на объекты, что мешает сборщику мусора.
- **Избыточное создание объектов**: Генерация множества объектов в памяти, которые не используются.

### Внесенные изменения
- **Удалены статические поля в генераторах**.
- **Улучшено управление жизненным циклом объектов**:
 - Использование локальных переменных вместо статических.
 - Загрузка данных из файлов только при необходимости.
- **Оптимизирован процесс генерации**:
 - Уменьшено количество временных объектов.

---

## Примеры использования

### Создание одного поста
1. Выберите `1` в меню.
2. Введите текст для поста.
3. Просмотрите созданный пост, выбрав `3`.

### Создание нескольких постов
1. Выберите `2` в меню.
2. Введите текст для постов.
3. Укажите количество создаваемых постов.
4. Просмотрите созданные посты, выбрав `3`.

### Удаление всех постов
1. Выберите `4` в меню.
2. Подтвердите удаление.

---

## Возможные улучшения

- **Удаление постов по ID**:
 - Добавить функциональность для удаления постов по ID.
- **Мониторинг памяти**:
 - Реализовать сбор информации об использовании памяти до и после очистки.
- **Тестирование**:
 - Добавить модульные тесты для генераторов и управления памятью.

---

## Вклад в проект

Ваш вклад приветствуется! Форкните репозиторий и отправьте pull request.

---

## Лицензия

Проект распространяется под лицензией MIT. Подробности см. в файле `LICENSE`.
